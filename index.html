<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cotizador Electricidad Vitt PRO 1.0</title>

<meta name="theme-color" content="#0b1220">
<link rel="manifest" href="/manifest.json">

<style>
:root{
--bg:#0b1220;
--card:#111c34;
--text:#e8eefc;
--muted:#94a3b8;
--accent:#4da3ff;
--accent2:#00d4ff;
--ok:#00e676;
--danger:#ff5252;
--radius:14px;
}

body{
margin:0;
padding:20px;
background:linear-gradient(180deg,#0b1220,#101a2f);
color:var(--text);
font-family:Arial, sans-serif;
}

.container{
max-width:1000px;
margin:auto;
}

h1{
margin:0;
font-size:20px;
}

.subtitle{
font-size:12px;
color:var(--muted);
margin-bottom:20px;
}

.card{
background:var(--card);
padding:15px;
border-radius:var(--radius);
margin-bottom:15px;
}

label{
font-size:12px;
color:var(--muted);
display:block;
margin-bottom:4px;
}

input,select{
width:100%;
padding:8px;
border-radius:8px;
border:none;
background:#1b2945;
color:white;
}

button{
padding:10px;
border-radius:10px;
border:none;
cursor:pointer;
font-weight:bold;
}

.btn{
background:linear-gradient(135deg,var(--accent),var(--accent2));
color:black;
}

.btn-danger{
background:var(--danger);
color:white;
}

.btn-ok{
background:var(--ok);
color:black;
}

.row{
display:flex;
gap:10px;
flex-wrap:wrap;
}

.col{
flex:1;
min-width:150px;
}

.work-item{
background:#16233f;
padding:10px;
border-radius:10px;
margin-bottom:10px;
}

.total{
font-size:22px;
font-weight:bold;
text-align:right;
margin-top:10px;
color:var(--ok);
}

.small{
font-size:12px;
color:var(--muted);
}
</style>
</head>

<body>

<div class="container">

<h1>⚡ Cotizador Electricidad Vitt PRO 1.0</h1>
<div class="subtitle">Soluciones Eléctricas</div>

<div class="card">
<div class="row">
<div class="col">
<label>Buscar trabajo</label>
<input id="search">
</div>
<div class="col">
<label>Categoría</label>
<select id="categoria"></select>
</div>
<div class="col">
<button class="btn" onclick="agregarTrabajo()">Agregar</button>
</div>
</div>
</div>

<div class="card">
<h3>Trabajos agregados</h3>
<div id="lista"></div>
<button class="btn-danger" onclick="limpiar()">Vaciar todo</button>
</div>

<div class="card">
<h3>Extras</h3>
<div class="row">
<div class="col">
<label>Materiales</label>
<input type="number" id="materiales" value="0">
</div>
<div class="col">
<label>Adicionales</label>
<input type="number" id="adicionales" value="0">
</div>
<div class="col">
<label>Margen (%)</label>
<input type="number" id="margen" value="0">
</div>
<div class="col">
<label>IVA 21%</label>
<input type="checkbox" id="iva">
</div>
</div>
<div class="total">
Total: $ <span id="total">0</span>
</div>
</div>

<div class="card">
<button class="btn-ok" onclick="copiar()">Copiar para WhatsApp</button>
<button class="btn" onclick="pdf()">PDF PRO</button>
</div>

</div>

<script>

const TRABAJOS = [
{cat:"Básicos",nombre:"Visita técnica",precio:45324},
{cat:"Básicos",nombre:"Boca completa",precio:90490},
{cat:"Básicos",nombre:"Hora de trabajo",precio:45324},

{cat:"Tableros",nombre:"TP Monofásico + PAT",precio:267314},
{cat:"Tableros",nombre:"TP Trifásico + PAT",precio:361993},

{cat:"Certificados",nombre:"Certificado T1 Monofásico",precio:347490},
{cat:"Certificados",nombre:"Certificado T1 Trifásico",precio:521235},

{cat:"Jornales",nombre:"Jornal Oficial Electricista (8hs)",precio:67523},
{cat:"Jornales",nombre:"Jornal Ayudante (8hs)",precio:57151}
];

let items=[];

const categoriaSelect=document.getElementById("categoria");
const searchInput=document.getElementById("search");

function cargarCategorias(){
let cats=["Todas"];
TRABAJOS.forEach(t=>{
if(!cats.includes(t.cat)) cats.push(t.cat);
});
categoriaSelect.innerHTML="";
cats.forEach(c=>{
let opt=document.createElement("option");
opt.textContent=c;
opt.value=c;
categoriaSelect.appendChild(opt);
});
}

function trabajosFiltrados(){
let q=searchInput.value.toLowerCase();
let cat=categoriaSelect.value;
return TRABAJOS.filter(t=>{
let okCat=(cat==="Todas"||t.cat===cat);
let okQ=t.nombre.toLowerCase().includes(q);
return okCat&&okQ;
});
}

function agregarTrabajo(){
let lista=trabajosFiltrados();
if(lista.length===0)return;
let t=lista[0];
items.push({nombre:t.nombre,precio:t.precio,cant:1});
render();
}

function eliminar(i){
items.splice(i,1);
render();
}

function limpiar(){
items=[];
render();
}

function render(){
let div=document.getElementById("lista");
div.innerHTML="";
items.forEach((it,i)=>{
let w=document.createElement("div");
w.className="work-item";
w.innerHTML=`
<b>${it.nombre}</b><br>
$${it.precio} x 
<input type="number" value="${it.cant}" min="1" onchange="cambiar(${i},this.value)">
<button class="btn-danger" onclick="eliminar(${i})">Eliminar</button>
`;
div.appendChild(w);
});
calcular();
}

function cambiar(i,val){
items[i].cant=parseInt(val)||1;
calcular();
}

function calcular(){
let subtotal=0;
items.forEach(it=>{
subtotal+=it.precio*it.cant;
});
let materiales=parseFloat(materiales.value)||0;
let adicionales=parseFloat(adicionales.value)||0;
let margen=parseFloat(margen.value)||0;
let ivaChk=iva.checked;

let total=subtotal+materiales+adicionales;
total+=total*(margen/100);
if(ivaChk) total*=1.21;

document.getElementById("total").textContent=total.toLocaleString();
}

function copiar(){
let texto="⚡ Cotizador Electricidad Vitt PRO 1.0\nSoluciones Eléctricas\n\n";
items.forEach(it=>{
texto+=`${it.nombre} x${it.cant} - $${(it.precio*it.cant).toLocaleString()}\n`;
});
texto+=`\nTOTAL: $${total.textContent}`;
navigator.clipboard.writeText(texto);
alert("Copiado");
}

function pdf(){
window.print();
}

searchInput.addEventListener("input",render);
categoriaSelect.addEventListener("change",render);

cargarCategorias();
render();

</script>

</body>
</html>
