<script>

const listaTrabajos = [
{ nombre:"Instalación toma corriente", precio:15000 },
{ nombre:"Instalación luminaria", precio:25000 },
{ nombre:"Armado tablero monofásico", precio:80000 },
{ nombre:"Armado tablero trifásico", precio:150000 },
{ nombre:"Instalación térmica", precio:20000 },
{ nombre:"Instalación disyuntor", precio:30000 },
{ nombre:"Cableado por punto", precio:18000 },
{ nombre:"Instalación ventilador techo", precio:30000 },
{ nombre:"Instalación reflector exterior", precio:35000 },
{ nombre:"Instalación puesta a tierra", precio:90000 },
{ nombre:"Instalación portero eléctrico", precio:60000 },
{ nombre:"Instalación cámara de seguridad", precio:45000 },
{ nombre:"Instalación DVR", precio:85000 },
{ nombre:"Revisión eléctrica completa", precio:70000 },
{ nombre:"Detección de fallas eléctricas", precio:40000 },
{ nombre:"Instalación automático bomba", precio:55000 },
{ nombre:"Instalación tablero industrial", precio:250000 }
];

function agregarTrabajo(){
let container = document.getElementById("trabajosContainer");

let div = document.createElement("div");
div.className = "card trabajo-item";

let selectHTML = `<select class="trabajo">`;
listaTrabajos.forEach((t)=>{
selectHTML += `<option value="${t.precio}">${t.nombre} - $${t.precio.toLocaleString()}</option>`;
});
selectHTML += `</select>`;

div.innerHTML = `
<div class="row">
<div>
<label>Trabajo</label>
${selectHTML}
</div>
<div>
<label>Cantidad</label>
<input type="number" class="cantidad" value="1" min="1">
</div>
</div>
<button onclick="eliminarTrabajo(this)" style="background:#ff4d4d;">Eliminar</button>
`;

container.appendChild(div);
calcular();
}

function eliminarTrabajo(btn){
btn.parentElement.remove();
calcular();
}

function calcular(){
let total = 0;

document.querySelectorAll(".trabajo-item").forEach(card=>{
let select = card.querySelector(".trabajo");
let cantidad = card.querySelector(".cantidad");

if(select && cantidad){
total += parseFloat(select.value) * parseFloat(cantidad.value || 0);
}
});

let materiales = parseFloat(document.getElementById("materiales").value) || 0;
let adicionales = parseFloat(document.getElementById("adicionales").value) || 0;
let margen = parseFloat(document.getElementById("margen").value) || 0;
let iva = document.getElementById("iva").checked;

let subtotal = total + materiales + adicionales;
let conMargen = subtotal + (subtotal * margen / 100);

if(iva){
conMargen = conMargen * 1.21;
}

document.getElementById("resultado").innerText = "Total: $" + conMargen.toLocaleString();
}

document.addEventListener("input", calcular);
agregarTrabajo();

</script>

<script>

const listaTrabajos = [
{ nombre:"Instalación toma corriente", precio:15000 },
{ nombre:"Instalación luminaria", precio:25000 },
{ nombre:"Armado tablero básico", precio:80000 },
{ nombre:"Instalación térmica y disyuntor", precio:50000 },
{ nombre:"Cableado por punto", precio:18000 },
{ nombre:"Instalación ventilador techo", precio:30000 },
{ nombre:"Instalación reflector exterior", precio:35000 }
];

function agregarTrabajo(){
let container = document.getElementById("trabajosContainer");

let div = document.createElement("div");
div.className = "card";

let selectHTML = `<select class="trabajo">`;
listaTrabajos.forEach((t,i)=>{
selectHTML += `<option value="${t.precio}">${t.nombre} - $${t.precio.toLocaleString()}</option>`;
});
selectHTML += `</select>`;

div.innerHTML = `
<div class="row">
<div>
<label>Trabajo</label>
${selectHTML}
</div>
<div>
<label>Cantidad</label>
<input type="number" class="cantidad" value="1">
</div>
</div>
`;

container.appendChild(div);
calcular();
}

function calcular(){
let total = 0;

document.querySelectorAll(".card").forEach(card=>{
let select = card.querySelector(".trabajo");
let cantidad = card.querySelector(".cantidad");

if(select && cantidad){
total += parseFloat(select.value) * parseFloat(cantidad.value || 0);
}
});

let materiales = parseFloat(document.getElementById("materiales").value) || 0;
let adicionales = parseFloat(document.getElementById("adicionales").value) || 0;
let margen = parseFloat(document.getElementById("margen").value) || 0;
let iva = document.getElementById("iva").checked;

let subtotal = total + materiales + adicionales;
let conMargen = subtotal + (subtotal * margen / 100);

if(iva){
conMargen = conMargen * 1.21;
}

document.getElementById("resultado").innerText = "Total: $" + conMargen.toLocaleString();
}

document.addEventListener("input", calcular);
agregarTrabajo();

</script>

</body>
</html>
